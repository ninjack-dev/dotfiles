#!/usr/bin/env bash

# Launches an application in the same directory as the active kitty window. 
# Adds ~50ms of latency to the launch of said app.
# 
# Relies on Kitty listening on kitty-<pid>, set in kitty.conf

cwd=$(kitty @ ls --to "unix:@kitty-$(hyprctl activewindow -j | jq '.pid')" | jq -r \
'
.[] | select(.is_active == true).tabs[] 
| select(.is_active == true).windows[]
| select(.is_active == true).cwd
'
) 2>/dev/null

cd "$cwd" && exec "$@"
